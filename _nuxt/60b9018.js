(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{341:function(e,t,n){"use strict";n.r(t);var r=n(9),c=(n(19),n(70),n(60),n(226)),o={layout:"noleft",mixins:[n(155)],data:function(){return{messages:[],channel:{},pusher:{},"입력메시지":""}},mounted:function(){var e=this;return Object(r.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.아이피입력(),e.채팅방입장();case 2:case"end":return t.stop()}}),t)})))()},methods:{"채팅방입장":function(){var e=this;return Object(r.a)(regeneratorRuntime.mark((function t(){var param,n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return param={ChatLimitNum:20},t.next=3,e.$axios.post("/chatSel",e.$qs.stringify(param));case 3:if(200!=(n=t.sent).data.code){t.next=8;break}e.messages=n.data.dbo,t.next=9;break;case 8:return t.abrupt("return");case 9:e.pusher=new c("407cb2ae1ebb455e1244",{cluster:"ap3"}),e.channel=e.pusher.subscribe("my-channel"),e.channel.bind("my-event",(function(data){e.messages.push({id:data.id,nickname:data.nickname,msg:data.msg})}));case 12:case"end":return t.stop()}}),t)})))()},"전송":function(){var e=this;return Object(r.a)(regeneratorRuntime.mark((function t(){var param,n,r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.입력메시지){t.next=3;break}return alert("메시지를 입력해 주세요."),t.abrupt("return");case 3:if(param={id:e.유저아이디,nickname:e.유저닉네임,msg:e.입력메시지},e.유저아이디){t.next=11;break}return t.next=7,e.$axios.get("https://api.ipify.org?format=json");case 7:n=t.sent,r=n.data.ip.split(".")[3],param.id="손님",param.nickname="손님"+r;case 11:return e.입력메시지="",t.next=14,e.$axios.post("/chatWrite",e.$qs.stringify(param));case 14:case"end":return t.stop()}}),t)})))()},"아이피입력":function(){var e=this;return Object(r.a)(regeneratorRuntime.mark((function t(){var n,r,param;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$axios.get("https://api.ipify.org?format=json");case 2:return n=t.sent,r=n.data.ip,param={bd_no:0,id:"chat",ip:r},t.next=7,e.$axios.post("/hitsUp",e.$qs.stringify(param));case 7:case"end":return t.stop()}}),t)})))()}}},l=n(21),component=Object(l.a)(o,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("div",{staticClass:"card"},[n("div",{staticClass:"card mt-4 pl-1 pr-1 ls2"},[n("nav",{staticClass:"panel is-primary"},[n("p",{staticClass:"panel-heading",staticStyle:{"font-size":"15px"}},[e._v("전체채팅")]),e._v(" "),n("div",{directives:[{name:"autobottom",rawName:"v-autobottom",value:!0,expression:"true"}],staticClass:"panel-block",staticStyle:{"hoverflow-y":"scroll"}},[n("div",e._l(e.messages,(function(t,i){return n("div",{key:i},[n("b",[e._v(e._s(t.nickname)+" :   ")]),e._v(" "),n("span",[e._v(e._s(t.msg))])])})),0)]),e._v(" "),n("div",{staticClass:"panel-block"},[n("input",{directives:[{name:"model",rawName:"v-model",value:e.입력메시지,expression:"입력메시지"}],staticClass:"input is-primary",attrs:{type:"text",placeholder:"채팅 입력",maxlength:"30"},domProps:{value:e.입력메시지},on:{keyup:function(t){if(!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter"))return null;e.전송()},input:function(t){t.target.composing||(e.입력메시지=t.target.value)}}}),e._v(" "),n("button",{staticClass:"button is-light",on:{click:function(t){e.전송()}}},[e._v("전송")])])])])])])}),[],!1,null,null,null);t.default=component.exports}}]);